<input id="query" name="query">

<div id="results"></div>


<style>
    input#query {
        width: 75%;
        height: 30px;
        top: 15px;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
    }

    div#results {
        margin-top: 60px;
        display: flex;
        flex-flow: wrap;
    }
    
    div.result {
        flex-basis: 0;
        min-width: 120px;
        padding: 4px 8px;
        flex-grow: 1;
        text-align: center;
        cursor: copy;
    }
</style>

<script src="icons.js"></script>
<script>
    const iconNames = Object.keys(mdiIcons);
    function buildNodesFromResults(results) {
        return results.map((result) => {
            let container = document.createElement('div');
            container.classList = 'result'
            container.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopImmediatePropagation();

                navigator.clipboard.writeText(result.icon);
            })
            let iconContainer = document.createElement('div')
            iconContainer.style.fontSize = '64px';
            iconContainer.style.fontFamily = 'Material Design Icons';
            iconContainer.innerText = result['icon']
            let labelContainer = document.createElement('div')
            labelContainer.style.fontSize = '14px';
            labelContainer.style.fontFamily = 'Cascadia Code';
            labelContainer.innerText = result['label']
            container.appendChild(iconContainer)
            container.appendChild(labelContainer);
            return container;
        })
    }

    function search(query) {
        query = query.trim().replace(/ /g, '-');
        // TODO: add sorting
        let nameResults = iconNames.filter((val) => val.indexOf(query) !== -1);
        if (nameResults.length > 150) nameResults = nameResults.slice(0, 150)
        nameResults.sort((a,b) => {
            return a.indexOf(query)
        })
        return nameResults.map((label) => ({label, icon: String.fromCodePoint(parseInt(mdiIcons[label], 16))}))
    }

    var input = document.getElementById('query');
    var resultsContainer = document.getElementById('results')
    input.addEventListener('keyup', function() {
        let results = search(input.value);
        let nodes = buildNodesFromResults(results);
        while (resultsContainer.firstChild) resultsContainer.removeChild(resultsContainer.firstChild)
        resultsContainer.append(...nodes);

    })

</script>